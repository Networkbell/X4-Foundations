<?xml version="1.0" encoding="utf-8"?>
<diff>

	<replace sel="/aiscript/attention//do_elseif[@value=&quot;($orderdef.$id == 'TradeRoutine') or ($orderdef.$id == 'TradeRoutine_Basic') or ($orderdef.$id == 'TradeRoutine_Advanced')&quot;]">
		<do_elseif value="($orderdef.$id == 'TradeRoutine') or ($orderdef.$id == 'TradeRoutine_Basic') or ($orderdef.$id == 'TradeRoutine_Advanced') or ($orderdef.$id == 'TradeRoutine_BasicMid') or ($orderdef.$id == 'TradeRoutine_Standard') or ($orderdef.$id == 'TradeRoutine_Expert')">
			<do_if value="$createdefaultorder? or (not $incompatiblewaretransport?)">
				<set_value name="$added"/>
				<do_if value="@this.assignedcontrolled.order.isrunning">
					<clear_order_failure order="this.assignedcontrolled.order"/>
				</do_if>
				<do_if value="@$order.$warebasket_override.count or @$orderdef.$warebasket_override.count">
					<do_if value="$createdefaultorder?">
						<create_order id="$orderdef.$id" object="this.assignedcontrolled" default="true">
							<param name="warebasket" value="$orderdef.$warebasket"/>
							<param name="range" value="$orderdef.$range"/>
							<param name="minbuy" value="$orderdef.$minbuy"/>
							<param name="maxbuy" value="$orderdef.$maxbuy"/>
							<param name="minsell" value="$orderdef.$minsell"/>
							<param name="maxsell" value="$orderdef.$maxsell"/>
							<param name="tradeforbuildstorage" value="$orderdef.$tradeforbuildstorage"/>
							<param name="usecover" value="$orderdef.$usecover"/>
							<param name="warebasket_override" value="$orderdef.$warebasket_override"/>
							<do_if value="$orderdef.$id == 'TradeRoutine_Standard'">
								<param name="maxwares" value="$orderdef.$maxwares"/>
							</do_if>
						</create_order>
					</do_if>
					<do_else>
						<set_value name="$orderdef.$warebasket" exact="$order.$warebasket"/>
						<set_value name="$orderdef.$range" exact="$order.$range"/>
						<set_value name="$orderdef.$minbuy" exact="$order.$minbuy"/>
						<set_value name="$orderdef.$maxbuy" exact="$order.$maxbuy"/>
						<set_value name="$orderdef.$minsell" exact="$order.$minsell"/>
						<set_value name="$orderdef.$maxsell" exact="$order.$maxsell"/>
						<set_value name="$orderdef.$tradeforbuildstorage" exact="$order.$tradeforbuildstorage"/>
						<set_value name="$orderdef.$usecover" exact="$order.$usecover"/>
						<set_value name="$orderdef.$warebasket_override" exact="$order.$warebasket_override"/>
						<do_if value="$orderdef.$id == 'TradeRoutine_Standard'">
							<set_value name="$orderdef.$maxwares" exact="$order.$maxwares"/>
						</do_if>
						<run_script name="$scriptname" sinceversion="2">
							<param name="warebasket" value="$order.$warebasket"/>
							<param name="range" value="$order.$range"/>
							<param name="minbuy" value="$order.$minbuy"/>
							<param name="maxbuy" value="$order.$maxbuy"/>
							<param name="minsell" value="$order.$minsell"/>
							<param name="maxsell" value="$order.$maxsell"/>
							<param name="tradeforbuildstorage" value="$order.$tradeforbuildstorage"/>
							<param name="usecover" value="$order.$usecover"/>
							<param name="warebasket_override" value="$order.$warebasket_override"/>
							<do_if value="$orderdef.$id == 'TradeRoutine_Standard'">
								<param name="maxwares" value="$order.$maxwares"/>
							</do_if>
						</run_script>
					</do_else>
				</do_if>
				<do_else>
					<do_if value="$createdefaultorder?">
						<create_order id="$orderdef.$id" object="this.assignedcontrolled" default="true">
							<param name="warebasket" value="$orderdef.$warebasket"/>
							<param name="range" value="$orderdef.$range"/>
							<param name="minbuy" value="$orderdef.$minbuy"/>
							<param name="maxbuy" value="$orderdef.$maxbuy"/>
							<param name="minsell" value="$orderdef.$minsell"/>
							<param name="maxsell" value="$orderdef.$maxsell"/>
							<param name="tradeforbuildstorage" value="$orderdef.$tradeforbuildstorage"/>
							<param name="usecover" value="$orderdef.$usecover"/>
							<do_if value="$orderdef.$id == 'TradeRoutine_Standard'">
								<param name="maxwares" value="$orderdef.$maxwares"/>
							</do_if>
						</create_order>
					</do_if>
					<do_else>
						<set_value name="$orderdef.$warebasket" exact="$order.$warebasket"/>
						<set_value name="$orderdef.$range" exact="$order.$range"/>
						<set_value name="$orderdef.$minbuy" exact="$order.$minbuy"/>
						<set_value name="$orderdef.$maxbuy" exact="$order.$maxbuy"/>
						<set_value name="$orderdef.$minsell" exact="$order.$minsell"/>
						<set_value name="$orderdef.$maxsell" exact="$order.$maxsell"/>
						<set_value name="$orderdef.$tradeforbuildstorage" exact="$order.$tradeforbuildstorage"/>
						<set_value name="$orderdef.$usecover" exact="$order.$usecover"/>
						<do_if value="$orderdef.$id == 'TradeRoutine_Standard'">
							<set_value name="$orderdef.$maxwares" exact="$order.$maxwares"/>
						</do_if>
						<run_script name="$scriptname">
							<param name="warebasket" value="$order.$warebasket"/>
							<param name="range" value="$order.$range"/>
							<param name="minbuy" value="$order.$minbuy"/>
							<param name="maxbuy" value="$order.$maxbuy"/>
							<param name="minsell" value="$order.$minsell"/>
							<param name="maxsell" value="$order.$maxsell"/>
							<param name="tradeforbuildstorage" value="$order.$tradeforbuildstorage"/>
							<param name="usecover" value="$order.$usecover"/>
							<do_if value="$orderdef.$id == 'TradeRoutine_Standard'">
								<param name="maxwares" value="$order.$maxwares"/>
							</do_if>
						</run_script>
					</do_else>
				</do_else>
			</do_if>
		</do_elseif>
	</replace>
	
	
	
	<replace sel="/aiscript/attention//do_elseif[@value=&quot;($orderdef.$id == 'MiningRoutine') or ($orderdef.$id == 'MiningRoutine_Advanced') or ($orderdef.$id == 'MiningRoutine_Basic') or ($orderdef.$id == 'MiningRoutine_Expert')&quot;]">
		<do_elseif value="($orderdef.$id == 'MiningRoutine') or ($orderdef.$id == 'MiningRoutine_Advanced') or ($orderdef.$id == 'MiningRoutine_Basic') or ($orderdef.$id == 'MiningRoutine_Expert') or ($orderdef.$id == 'MiningRoutine_BasicMid') or ($orderdef.$id == 'MiningRoutine_Standard')">
			<do_if value="(this.assignedcontrolled.primarypurpose == purpose.mine) and ($createdefaultorder? or (not $incompatiblewaretransport?) or ($commander.waretransport.indexof.{waretransport.solid} and this.assignedcontrolled.waretransport.indexof.{waretransport.solid}) or ($commander.waretransport.indexof.{waretransport.liquid} and this.assignedcontrolled.waretransport.indexof.{waretransport.liquid}))">
				<set_value name="$added"/>
				<do_if value="@this.assignedcontrolled.order.isrunning">
					<clear_order_failure order="this.assignedcontrolled.order"/>
				</do_if>
				<do_if value="@$order.$warebasket_override.count or @$orderdef.$warebasket_override.count">
					<do_if value="$createdefaultorder?">
						<create_order id="$orderdef.$id" object="this.assignedcontrolled" default="true">
							<param name="warebasket" value="$orderdef.$warebasket"/>
							<param name="range" value="$orderdef.$range"/>
							<param name="minbuy" value="$orderdef.$minbuy"/>
							<param name="maxbuy" value="$orderdef.$maxbuy"/>
							<param name="minsell" value="$orderdef.$minsell"/>
							<param name="maxsell" value="$orderdef.$maxsell"/>
							<param name="warebasket_override" value="$orderdef.$warebasket_override"/>
							<do_if value="$orderdef.$id == 'MiningRoutine_Standard'">
								<param name="maxwares" value="$orderdef.$maxwares"/>
							</do_if>
						</create_order>
					</do_if>
					<do_else>
						<set_value name="$orderdef.$warebasket" exact="$order.$warebasket"/>
						<set_value name="$orderdef.$range" exact="$order.$range"/>
						<set_value name="$orderdef.$minbuy" exact="$order.$minbuy"/>
						<set_value name="$orderdef.$maxbuy" exact="$order.$maxbuy"/>
						<set_value name="$orderdef.$minsell" exact="$order.$minsell"/>
						<set_value name="$orderdef.$maxsell" exact="$order.$maxsell"/>
						<set_value name="$orderdef.$warebasket_override" exact="$order.$warebasket_override"/>
						<do_if value="$orderdef.$id == 'MiningRoutine_Standard'">
							<set_value name="$orderdef.$maxwares" exact="$order.$maxwares"/>
						</do_if>
						<run_script name="$scriptname" sinceversion="2">
							<param name="warebasket" value="$order.$warebasket"/>
							<param name="range" value="$order.$range"/>
							<param name="minbuy" value="$order.$minbuy"/>
							<param name="maxbuy" value="$order.$maxbuy"/>
							<param name="minsell" value="$order.$minsell"/>
							<param name="maxsell" value="$order.$maxsell"/>
							<param name="warebasket_override" value="$order.$warebasket_override"/>
							<do_if value="$orderdef.$id == 'MiningRoutine_Standard'">
								<param name="maxwares" value="$order.$maxwares"/>
							</do_if>
						</run_script>
					</do_else>
				</do_if>
				<do_else>
					<do_if value="$createdefaultorder?">
						<create_order id="$orderdef.$id" object="this.assignedcontrolled" default="true">
							<param name="warebasket" value="$orderdef.$warebasket"/>
							<param name="range" value="$orderdef.$range"/>
							<param name="minbuy" value="$orderdef.$minbuy"/>
							<param name="maxbuy" value="$orderdef.$maxbuy"/>
							<param name="minsell" value="$orderdef.$minsell"/>
							<param name="maxsell" value="$orderdef.$maxsell"/>
							<do_if value="$orderdef.$id == 'MiningRoutine_Standard'">
								<param name="maxwares" value="$orderdef.$maxwares"/>
							</do_if>
						</create_order>
					</do_if>
					<do_else>
						<set_value name="$orderdef.$warebasket" exact="$order.$warebasket"/>
						<set_value name="$orderdef.$range" exact="$order.$range"/>
						<set_value name="$orderdef.$minbuy" exact="$order.$minbuy"/>
						<set_value name="$orderdef.$maxbuy" exact="$order.$maxbuy"/>
						<set_value name="$orderdef.$minsell" exact="$order.$minsell"/>
						<set_value name="$orderdef.$maxsell" exact="$order.$maxsell"/>
						<do_if value="$orderdef.$id == 'MiningRoutine_Standard'">
							<set_value name="$orderdef.$maxwares" exact="$order.$maxwares"/>
						</do_if>
						<run_script name="$scriptname">
							<param name="warebasket" value="$order.$warebasket"/>
							<param name="range" value="$order.$range"/>
							<param name="minbuy" value="$order.$minbuy"/>
							<param name="maxbuy" value="$order.$maxbuy"/>
							<param name="minsell" value="$order.$minsell"/>
							<param name="maxsell" value="$order.$maxsell"/>
							<do_if value="$orderdef.$id == 'MiningRoutine_Standard'">
								<param name="maxwares" value="$order.$maxwares"/>
							</do_if>
						</run_script>
					</do_else>
				</do_else>
			</do_if>
			<do_elseif value="this.assignedcontrolled.primarypurpose != purpose.mine">
				<set_value name="$failurereason" exact="{1045,158}" comment="This ship type cannot mine."/>
			</do_elseif>
			<do_elseif value="$incompatiblewaretransport?">
				<set_value name="$failurereason" exact="{1045,156}" comment="This ship type cannot carry the required wares."/>
			</do_elseif>
		</do_elseif>
	</replace>
</diff>